{% extends "mainapp/base_without_menu.html" %}

{% load staticfiles %}
{% block title %}
    {{ chapter.name }} - mehr.
{% endblock %}
{% block js %}
    <script src='{% static "mainapp/js/chapter.js" %}'></script>
    {% with next_chapter=chapter.get_next %}
    {% if next_chapter %}
    <script type='text/javascript'>
        function myHandler(e) {
            document.location.href = "{% url 'mainapp:chapterPage' person.id next_chapter.get_relative_id %}";
        }
        document.getElementById('chapterVideo').addEventListener('ended', myHandler, false);
    </script>
    {% endif %}
    {% endwith %}
{% endblock %}
{% block css %}
    <link href='{% static "mainapp/css/chapter.css" %}' rel="stylesheet" type="text/css" />
    <link href='{% static "mainapp/css/util_video_fullscreen.css" %}' rel="stylesheet" type="text/css" />
{% endblock %}
{% block content %}
<div class="timeline">
    <progress value="22" max="100"></progress>
</div>
<div class="box">
    <div>
        <a class="header" href="#">...</a>
    </div>
    <div>
        <a class="mehr" href="#layer-container">mehr.</a>
    </div>
</div>
<!--FIXME: remove muted attr -->
<video id="chapterVideo" poster='{% static "mainapp/images/yeah.jpg" %}' autoplay muted>
    <source src="{{ chapter.video.url }}" type="video/mp4">
    <source src="{{ chapter.video.url }}" type="video/webm">
    Your browser does not support the video tag.
</video>
{% if chapter.get_additional_count >= 0 %}
<div id="layer-container" class="layer-container">
    {% for layer in chapter.additionalcontent_set.all %}
    <div class="layer" style="background-image: url('{{ layer.image.url }}');">
        <div class="layer-title">{{layer.name}}</div>
        <div class="layer-description">{{layer.description}}</div>
        <!--<a href="{% url 'mainapp:additionalContentPage' person.id chapter.get_relative_id layer.index %}">{{ add2.name }}</a>-->
    </div>
    {% endfor %}
</div>
{% endif %}

{% endblock %}
